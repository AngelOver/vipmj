import{_ as E}from"./nuxt-link.b5f02e4c.js";import{d as H,a as K,r as b,Z as V,K as L,b as p,o as y,c as T,e as c,g as e,w as t,h as w,$ as Z,f as _,M as u,i as q,t as C,j as N}from"./entry.f78ca6a6.js";import{u as A,a4 as G,a5 as J,a6 as O,a7 as Q,a8 as W}from"./counter.a6829455.js";const X={class:"authentication"},Y={class:"container d-flex flex-column"},ee={class:"row align-items-center justify-content-center no-gutters min-vh-100"},se={class:"col-12 col-md-7 col-lg-5 col-xl-4 py-md-11"},te={class:"card border-0 shadow-sm"},ae={class:"card-body"},le=c("h3",{class:"text-center"},"重置密码",-1),oe=c("p",{class:"text-center mb-6"}," 请在下面输入你的电子邮件地址，并且发送验证码到你的邮箱。 ",-1),re={class:"text-center mb-0"},ce=H({__name:"reset",setup(ne){const h=A();K({title:"重置密码 - "+h.setting.title,meta:[{name:"description",content:h.setting.description},{name:"keywords",content:h.setting.keywords}]}),(()=>{G().then(d=>{h.setting=d._rawValue.data}).catch(d=>{u.error(d)})})();const f=h.setting.register_way,v=f==="1"?"first":f=="2"?"second":"first",g=b("发送验证码"),R=b(),P=b(),r=V({email:"",email_code:"",password:"",password_c:""}),n=V({phone:"",phone_code:"",password:"",password_c:""}),B=V({email:[{required:!0,message:"请输入邮箱",trigger:"blur"},{type:"email",message:"请输入正确的邮箱地址",trigger:["blur","change"]}],email_code:[{required:!0,message:"请输入邮箱验证码",trigger:"blur"}],password:[{required:!0,message:"请输入密码",trigger:"blur"},{min:8,message:"密码长度不能小于8位",trigger:"blur"}],password_c:[{required:!0,message:"请确认密码",trigger:"blur"},{min:8,message:"密码长度不能小于8位",trigger:"blur"}]}),I=V({phone:[{required:!0,message:"请输入手机号",trigger:"blur"},{pattern:/^1[3456789]\d{9}$/,message:"请输入正确的手机号",trigger:"blur"}],phone_code:[{required:!0,message:"请输入手机验证码",trigger:"blur"}],password:[{required:!0,message:"请输入密码",trigger:"blur"},{min:8,message:"密码长度不能小于8位",trigger:"blur"}],password_c:[{required:!0,message:"请确认密码",trigger:"blur"},{min:8,message:"密码长度不能小于8位",trigger:"blur"}]}),k=L(),i=b(!1),$=async({values:d,errors:s})=>{if(s)return u.error("请填写正确的信息"),!1;if(r.password!=r.password_c){u.error("两次密码不一致");return}i.value=!0,J({email:r.email,email_code:r.email_code,password:r.password}).then(o=>{if(o._rawValue.status==200){let a=60;const m=setInterval(()=>{a>0&&a<=60?(a--,g.value=a+"s"):(clearInterval(m),g.value="发送验证码")},1e3);u.success(o._rawValue.message),k.push({path:"/"}),i.value=!1}}).catch(o=>{i.value=!1,console.log(o)})},j=async({values:d,errors:s})=>{if(s)return u.error("请填写正确的信息"),!1;if(n.password!=n.password_c){u.error("两次密码不一致");return}i.value=!0,O({phone:n.phone,phone_code:n.phone_code,password:n.password}).then(o=>{if(o._rawValue.status==200){let a=60;const m=setInterval(()=>{a>0&&a<=60?(a--,g.value=a+"s"):(clearInterval(m),g.value="发送验证码")},1e3);u.success(o._rawValue.message),k.push({path:"/"}),i.value=!1}}).catch(o=>{i.value=!1,console.log(o)})},z=()=>{if(r.email==""){u.error("请填写邮箱");return}Q({email:r.email,type:"reset"}).then(d=>{d._rawValue.status==200&&u.success(d._rawValue.message)}).catch(d=>{console.log(d)})},S=()=>{if(n.phone==""){u.error("请填写手机号");return}W({phone:n.phone,type:"reset"}).then(d=>{d._rawValue.status==200&&u.success(d._rawValue.message)}).catch(d=>{console.log(d)})};return(d,s)=>{const o=p("a-input"),a=p("a-form-item"),m=p("a-button"),x=p("a-space"),F=p("a-form"),U=p("a-tab-pane"),M=p("a-tabs"),D=E;return y(),T("div",X,[c("div",Y,[c("div",ee,[c("div",se,[c("div",te,[c("div",ae,[le,oe,e(M,{modelValue:w(v),"onUpdate:modelValue":s[10]||(s[10]=l=>Z(v)?v.value=l:null),type:"capsule",size:"large",class:"justify-content-center mt-2"},{default:t(()=>[w(f)=="1"||w(f)=="3"?(y(),q(U,{title:"邮箱验证",key:"first"},{default:t(()=>[e(F,{onSubmit:$,ref_key:"ruleFormRef",ref:R,model:r,rules:B,class:"demo-ruleForm","status-icon":""},{default:t(()=>[e(a,{field:"email","hide-label":!0},{default:t(()=>[e(o,{modelValue:r.email,"onUpdate:modelValue":s[0]||(s[0]=l=>r.email=l),placeholder:"请填写您的邮箱"},null,8,["modelValue"])]),_:1}),e(a,{field:"email_code","hide-label":!0},{default:t(()=>[e(x,null,{default:t(()=>[e(o,{modelValue:r.email_code,"onUpdate:modelValue":s[1]||(s[1]=l=>r.email_code=l),placeholder:"请填写您的邮箱验证码"},null,8,["modelValue"]),e(m,{type:"primary",onClick:s[2]||(s[2]=l=>z())},{default:t(()=>[_(C(g.value),1)]),_:1})]),_:1})]),_:1}),e(a,{field:"password","hide-label":!0},{default:t(()=>[e(o,{modelValue:r.password,"onUpdate:modelValue":s[3]||(s[3]=l=>r.password=l),placeholder:"填写您的密码"},null,8,["modelValue"])]),_:1}),e(a,{field:"password","hide-label":!0},{default:t(()=>[e(o,{modelValue:r.password_c,"onUpdate:modelValue":s[4]||(s[4]=l=>r.password_c=l),placeholder:"确认您的密码"},null,8,["modelValue"])]),_:1}),e(a,{"hide-label":!0},{default:t(()=>[e(m,{type:"primary",loading:i.value,class:"register",size:"large","html-type":"submit"},{default:t(()=>[_(" 重置密码 ")]),_:1},8,["loading"])]),_:1})]),_:1},8,["model","rules"])]),_:1})):N("",!0),w(f)=="2"||w(f)=="3"?(y(),q(U,{title:"手机验证",key:"second"},{default:t(()=>[e(F,{ref_key:"ruleFormRefP",ref:P,model:n,rules:I,class:"demo-ruleForm","status-icon":"",onSubmit:j},{default:t(()=>[e(a,{field:"phone","hide-label":!0},{default:t(()=>[e(o,{modelValue:n.phone,"onUpdate:modelValue":s[5]||(s[5]=l=>n.phone=l),placeholder:"请填写您的手机号"},null,8,["modelValue"])]),_:1}),e(a,{field:"phone_code","hide-label":!0},{default:t(()=>[e(x,null,{default:t(()=>[e(o,{modelValue:n.phone_code,"onUpdate:modelValue":s[6]||(s[6]=l=>n.phone_code=l),placeholder:"请填写您的手机验证码"},null,8,["modelValue"]),e(m,{type:"primary",onClick:s[7]||(s[7]=l=>S())},{default:t(()=>[_(C(g.value),1)]),_:1})]),_:1})]),_:1}),e(a,{field:"password","hide-label":!0},{default:t(()=>[e(o,{type:"password",class:"form-control form-control-lg",modelValue:n.password,"onUpdate:modelValue":s[8]||(s[8]=l=>n.password=l),placeholder:"填写您的密码"},null,8,["modelValue"])]),_:1}),e(a,{field:"password","hide-label":!0},{default:t(()=>[e(o,{type:"password",class:"form-control form-control-lg",modelValue:n.password_c,"onUpdate:modelValue":s[9]||(s[9]=l=>n.password_c=l),placeholder:"确认您的密码"},null,8,["modelValue"])]),_:1}),e(a,{"hide-label":!0},{default:t(()=>[e(m,{type:"primary",loading:i.value,class:"register",size:"large","html-type":"submit"},{default:t(()=>[_(" 重置密码 ")]),_:1},8,["loading"])]),_:1})]),_:1},8,["model","rules"])]),_:1})):N("",!0)]),_:1},8,["modelValue"]),c("p",re,[_("已经有账户了？"),e(D,{class:"link",to:"/"},{default:t(()=>[_("登录")]),_:1}),_(".")])])])])])])])}}});export{ce as default};
