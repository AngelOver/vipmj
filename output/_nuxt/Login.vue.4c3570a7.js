import{_ as Me}from"./nuxt-link.6d97cfe9.js";import{p as Q,d as W,q as X,s as z,x as Y,o as b,c as V,n as ee,y as te,e as a,r as p,Z as j,u as A,K as Be,b as k,i as R,w as l,g as s,f,h as g,j as P,t as _e,$ as pe,M as v}from"./entry.a883e4b9.js";import{u as Re,al as Pe,a8 as We,am as Te,an as fe,ao as Ee,a6 as Oe,a7 as He}from"./counter.e394fb0e.js";import{I as Ze,b as ge,a as Ae,_ as De}from"./wechat.4fd29ae4.js";const Ke=W({name:"IconCode",props:{size:{type:[Number,String]},strokeWidth:{type:Number,default:4},strokeLinecap:{type:String,default:"butt",validator:e=>["butt","round","square"].includes(e)},strokeLinejoin:{type:String,default:"miter",validator:e=>["arcs","bevel","miter","miter-clip","round"].includes(e)},rotate:Number,spin:Boolean},emits:{click:e=>!0},setup(e,{emit:n}){const r=X("icon"),_=z(()=>[r,`${r}-code`,{[`${r}-spin`]:e.spin}]),h=z(()=>{const u={};return e.size&&(u.fontSize=Y(e.size)?`${e.size}px`:e.size),e.rotate&&(u.transform=`rotate(${e.rotate}deg)`),u});return{cls:_,innerStyle:h,onClick:u=>{n("click",u)}}}}),Ge=["stroke-width","stroke-linecap","stroke-linejoin"],Je=a("path",{d:"M16.734 12.686 5.42 24l11.314 11.314m14.521-22.628L42.57 24 31.255 35.314M27.2 6.28l-6.251 35.453"},null,-1),Qe=[Je];function Xe(e,n,r,_,h,y){return b(),V("svg",{viewBox:"0 0 48 48",fill:"none",xmlns:"http://www.w3.org/2000/svg",stroke:"currentColor",class:ee(e.cls),style:te(e.innerStyle),"stroke-width":e.strokeWidth,"stroke-linecap":e.strokeLinecap,"stroke-linejoin":e.strokeLinejoin,onClick:n[0]||(n[0]=(...u)=>e.onClick&&e.onClick(...u))},Qe,14,Ge)}var D=Q(Ke,[["render",Xe]]);const ve=Object.assign(D,{install:(e,n)=>{var r;const _=(r=n==null?void 0:n.iconPrefix)!=null?r:"";e.component(_+D.name,D)}}),Ye=W({name:"IconEmail",props:{size:{type:[Number,String]},strokeWidth:{type:Number,default:4},strokeLinecap:{type:String,default:"butt",validator:e=>["butt","round","square"].includes(e)},strokeLinejoin:{type:String,default:"miter",validator:e=>["arcs","bevel","miter","miter-clip","round"].includes(e)},rotate:Number,spin:Boolean},emits:{click:e=>!0},setup(e,{emit:n}){const r=X("icon"),_=z(()=>[r,`${r}-email`,{[`${r}-spin`]:e.spin}]),h=z(()=>{const u={};return e.size&&(u.fontSize=Y(e.size)?`${e.size}px`:e.size),e.rotate&&(u.transform=`rotate(${e.rotate}deg)`),u});return{cls:_,innerStyle:h,onClick:u=>{n("click",u)}}}}),et=["stroke-width","stroke-linecap","stroke-linejoin"],tt=a("rect",{x:"6",y:"8",width:"36",height:"32",rx:"1"},null,-1),st=a("path",{d:"m37 17-12.43 8.606a1 1 0 0 1-1.14 0L11 17"},null,-1),lt=[tt,st];function ot(e,n,r,_,h,y){return b(),V("svg",{viewBox:"0 0 48 48",fill:"none",xmlns:"http://www.w3.org/2000/svg",stroke:"currentColor",class:ee(e.cls),style:te(e.innerStyle),"stroke-width":e.strokeWidth,"stroke-linecap":e.strokeLinecap,"stroke-linejoin":e.strokeLinejoin,onClick:n[0]||(n[0]=(...u)=>e.onClick&&e.onClick(...u))},lt,14,et)}var K=Q(Ye,[["render",ot]]);const at=Object.assign(K,{install:(e,n)=>{var r;const _=(r=n==null?void 0:n.iconPrefix)!=null?r:"";e.component(_+K.name,K)}}),it=W({name:"IconLock",props:{size:{type:[Number,String]},strokeWidth:{type:Number,default:4},strokeLinecap:{type:String,default:"butt",validator:e=>["butt","round","square"].includes(e)},strokeLinejoin:{type:String,default:"miter",validator:e=>["arcs","bevel","miter","miter-clip","round"].includes(e)},rotate:Number,spin:Boolean},emits:{click:e=>!0},setup(e,{emit:n}){const r=X("icon"),_=z(()=>[r,`${r}-lock`,{[`${r}-spin`]:e.spin}]),h=z(()=>{const u={};return e.size&&(u.fontSize=Y(e.size)?`${e.size}px`:e.size),e.rotate&&(u.transform=`rotate(${e.rotate}deg)`),u});return{cls:_,innerStyle:h,onClick:u=>{n("click",u)}}}}),nt=["stroke-width","stroke-linecap","stroke-linejoin"],rt=a("rect",{x:"7",y:"21",width:"34",height:"20",rx:"1"},null,-1),ut=a("path",{d:"M15 21v-6a9 9 0 1 1 18 0v6M24 35v-8"},null,-1),dt=[rt,ut];function ct(e,n,r,_,h,y){return b(),V("svg",{viewBox:"0 0 48 48",fill:"none",xmlns:"http://www.w3.org/2000/svg",stroke:"currentColor",class:ee(e.cls),style:te(e.innerStyle),"stroke-width":e.strokeWidth,"stroke-linecap":e.strokeLinecap,"stroke-linejoin":e.strokeLinejoin,onClick:n[0]||(n[0]=(...u)=>e.onClick&&e.onClick(...u))},dt,14,nt)}var G=Q(it,[["render",ct]]);const J=Object.assign(G,{install:(e,n)=>{var r;const _=(r=n==null?void 0:n.iconPrefix)!=null?r:"";e.component(_+G.name,G)}}),he=""+new URL("safe_login.1d99930b.png",import.meta.url).href,mt=["innerHTML"],_t={class:"dialog-footer"},pt={class:"w-100 dialog_login"},ft={key:0,class:"card login_card border-0"},gt={class:"card-body"},vt=a("img",{src:he,alt:"",class:"w-28 m-auto mb-2"},null,-1),ht=a("p",{class:"text-center mb-6"},"登录自主用户，开始聊天",-1),kt={class:"form-group d-flex justify-content-between mb-2"},bt={key:0,class:"mt-6"},wt=a("div",{class:"relative"},[a("div",{class:"absolute inset-0 flex items-center"},[a("div",{class:"w-full border-t border-gray-300"})]),a("div",{class:"relative flex justify-center text-sm"},[a("span",{class:"bg-white px-2 text-gray-500"},"第三方登录")])],-1),yt={key:0,class:"mt-3 grid grid-cols-1 gap-1 mb-3"},xt=a("span",{class:"sr-only"},"Sign in with Twitter",-1),Vt=a("svg",{t:"1684751208419",class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"23618",width:"26",height:"26"},[a("path",{d:"M512 512m-447.9 0a447.9 447.9 0 1 0 895.8 0 447.9 447.9 0 1 0-895.8 0Z",fill:"#00C785","p-id":"23619"}),a("path",{d:"M741.6 567.5c0-63.7-63.7-115.5-135.3-115.5-75.9 0-135.5 51.9-135.5 115.5 0 63.8 59.6 115.5 135.5 115.5 15.9 0 31.9-4 47.8-7.9l43.7 24-12-39.8c32-24 55.8-56 55.8-91.8z m-179.3-19.9c-7.9 0-15.9-7.9-15.9-15.9 0-7.9 7.9-15.9 15.9-15.9 12 0 20 7.9 20 15.9s-8 15.9-20 15.9z m87.7 0c-7.9 0-15.8-7.9-15.8-15.9 0-7.9 7.9-15.9 15.8-15.9 12 0 19.9 7.9 19.9 15.9 0.1 8-8.1 15.9-19.9 15.9z m0 0",fill:"#FFFFFF","p-id":"23620"}),a("path",{d:"M593.1 437.9c5.2 0 10.5 0.4 15.7 0.9-14-65.6-84.1-114.2-164.1-114.2-89.4 0-162.7 60.9-162.7 138.3 0 44.7 24.3 81.4 65 109.9l-16.2 49 56.9-28.6c20.4 4 36.7 8.1 56.9 8.1 5 0 10.1-0.2 15.1-0.7-3.2-10.8-5-22.3-5-34.1 0.1-70.9 61.2-128.6 138.4-128.6z m-87.5-44.1c12.2 0 20.3 8.1 20.3 20.4 0 12.2-8.1 20.3-20.3 20.3-12.3 0-24.5-8.1-24.5-20.3 0.2-12.3 12.4-20.4 24.5-20.4z m-113.9 40.7c-12.3 0-24.5-8.1-24.5-20.3 0-12.3 12.2-20.4 24.5-20.4s20.4 8.1 20.4 20.4c0 12-8.1 20.3-20.4 20.3z m0 0",fill:"#FFFFFF","p-id":"23621"})],-1),$t=[xt,Vt],Ct={class:"text-center mb-0"},Lt={key:1,class:"card login_card border-0"},zt={class:"card-body"},Ft=a("img",{src:De,alt:"",class:"m-auto mb-2"},null,-1),St=a("p",{class:"text-center mb-6"},"打开微信[扫一扫]登录",-1),It={key:2,class:"card register_card border-0"},jt={class:"card-body"},Ut=a("img",{src:he,alt:"",class:"w-28 m-auto mb-2"},null,-1),Nt=a("p",{class:"text-center mb-6"},"创建一个免费账户",-1),qt={class:"text-center mb-0"},Wt=W({__name:"Login",props:{login_dialog:{type:Boolean,default:!1}},emits:["handleCancel"],setup(e,{emit:n}){const r=e,_=Re(),h=p(!0),y=p(),u=()=>{y.value="",h.value=!1},N=()=>{y.value="",h.value=!0},q=z({get(){return r.login_dialog},set(i){n("handleCancel",i)}}),ke=()=>{q.value=!1};p(""),p("");const be=p(),C=j({email:"",password:""});j({email:[{required:!0,message:"请输入邮箱或手机号",trigger:"blur"}],password:[{required:!0,message:"请输入密码",trigger:"blur"},{min:6,max:20,message:"密码长度在 6 到 20 个字符",trigger:"blur"}]});const M=p(!1),se=A("token",{maxAge:60*60*24*2}),le=A("user_info"),oe=Be(),ae=A("message"),we=async({values:i,errors:t})=>{if(t)return v.error("请填写登录信息"),!1;M.value=!0,Pe({email:C.email,password:C.password}).then(d=>{M.value=!1,d._rawValue.status==200&&(ke(),ae.value="",se.value=d._rawValue.token,le.value=d._rawValue.user_info,v.success(d._rawValue.message),oe.go(0))}).catch(d=>{M.value=!1})},ie=p(),ne=p(!1),ye=()=>{h.value=!1,ne.value=!0,We({type:"login"}).then(i=>{y.value=i._rawValue.data,ie.value=i._rawValue.id;let t=setInterval(()=>{Te({id:ie.value}).then(d=>{d._rawValue.status==200&&(clearInterval(t),ae.value="",se.value=d._rawValue.token,le.value=d._rawValue.user_info,v.success(d._rawValue.message),oe.go(0))}).catch(d=>{clearInterval(t)})},3e3)}).catch(i=>{v.error(i)})},F=p(_.setting.register_way?_.setting.register_way:"1"),xe=p(),Ve=p(),c=j({email:"",password:"",email_code:"",invite_code:"",check_xieyi:!1}),m=j({phone:"",password:"",phone_code:"",invite_code:"",check_xieyi:!1});{const i=new URLSearchParams(window.location.search);i.get("invite_code")&&(c.invite_code=i.get("invite_code"),m.invite_code=i.get("invite_code"))}const $e=j({phone:[{required:!0,message:"请输入手机号",trigger:"blur"},{match:/^1[3456789]\d{9}$/,message:"请输入正确的手机号",trigger:["blur","change"]}],password:[{required:!0,message:"请输入密码",trigger:"blur"},{min:6,max:20,message:"密码长度在 6 到 20 个字符",trigger:"blur"}],phone_code:[{required:!0,message:"请输入手机验证码",trigger:"blur"}]}),re=()=>{B.value=!0,ze()},Ce=j({email:[{required:!0,message:"请输入邮箱地址",trigger:"blur"},{type:"email",message:"请输入正确的邮箱地址",trigger:["blur","change"]}],password:[{required:!0,message:"请输入密码",trigger:"blur"},{min:6,max:20,message:"密码长度在 6 到 20 个字符",trigger:"blur"}],email_code:[{required:!0,message:"请输入邮箱验证码",trigger:"blur"}]}),$=p(!1),Le=async({values:i,errors:t})=>{if(t)return v.error("请补全注册信息"),!1;if(c.check_xieyi==!1){v.error("请同意用户协议");return}$.value=!0,fe({email:c.email,password:c.password,email_code:c.email_code,invite_code:c.invite_code}).then(d=>{d._rawValue.status==200&&(v.success(d._rawValue.message),N(),$.value=!1)}).catch(d=>{$.value=!1})},B=p(!1),T=p({}),U=p(!1),ze=()=>{U.value=!0,Ee().then(i=>{T.value=i._rawValue.data,U.value=!1}).catch(i=>{console.log(i),U.value=!1})},Fe=()=>{B.value=!1,c.check_xieyi=!0,m.check_xieyi=!0},Se=async({values:i,errors:t})=>{if(t)return v.error("请补全注册信息"),!1;if(m.check_xieyi==!1){v.error("请同意用户协议");return}$.value=!0,fe({phone:m.phone,password:m.password,phone_code:m.phone_code,invite_code:m.invite_code}).then(d=>{d._rawValue.status==200&&(v.success(d._rawValue.message),N(),$.value=!1)}).catch(d=>{$.value=!1})},S=p("发送验证码"),x=p(!1),E=F==="1"?"first":F=="2"?"second":"first",Ie=()=>{if(c.email==""){v.error("请填写邮箱");return}x.value=!0,Oe({email:c.email}).then(i=>{if(i._rawValue.status==200){v.success(i._rawValue.message);let t=60;const d=setInterval(()=>{if(t<=0){S.value="发送验证码",x.value=!1,clearInterval(d);return}S.value=t+"s",x.value=!0,t--},1e3)}}).catch(i=>{x.value=!1,console.log(i)})},je=()=>{if(m.phone==""){v.error("请填写手机号");return}x.value=!0,He({phone:m.phone}).then(i=>{if(i._rawValue.status==200){v.success(i._rawValue.message);let t=60;const d=setInterval(()=>{if(t<=0){S.value="发送验证码",x.value=!1,clearInterval(d);return}S.value=t+"s",x.value=!0,t--},1e3)}}).catch(i=>{x.value=!1,console.log(i)})};return(i,t)=>{const d=k("a-skeleton-line"),O=k("a-space"),Ue=k("a-skeleton"),I=k("a-button"),ue=k("a-modal"),L=k("a-input"),w=k("a-form-item"),H=k("a-input-password"),de=Me,Z=k("a-form"),Ne=k("a-image"),ce=k("a-checkbox"),me=k("a-tab-pane"),qe=k("a-tabs");return b(),R(ue,{footer:!1,visible:g(q),"onUpdate:visible":t[22]||(t[22]=o=>pe(q)?q.value=o:null),simple:"",class:"mb_dialog dialog_login_of"},{default:l(()=>[s(ue,{visible:B.value,"onUpdate:visible":t[1]||(t[1]=o=>B.value=o),title:T.value.title,class:"dialog_login_of"},{footer:l(()=>[a("span",_t,[s(I,{type:"primary",onClick:t[0]||(t[0]=o=>Fe())},{default:l(()=>[f(" 同意协议 ")]),_:1})])]),default:l(()=>[U.value?(b(),R(Ue,{key:0,animation:U.value},{default:l(()=>[s(O,{direction:"vertical",style:{width:"100%"},size:"large"},{default:l(()=>[s(d,{rows:3})]),_:1})]),_:1},8,["animation"])):(b(),V("div",{key:1,innerHTML:T.value.description},null,8,mt))]),_:1},8,["visible","title"]),a("div",pt,[h.value?(b(),V("div",ft,[a("div",gt,[vt,ht,s(Z,{ref_key:"ruleFormRefLogin",ref:be,model:C,class:"demo-ruleForm","status-icon":"",onSubmit:we},{default:l(()=>[s(w,{"hide-label":!0,field:"email",rules:[{required:!0,message:"邮箱或手机号不得为空"}]},{default:l(()=>[s(L,{modelValue:C.email,"onUpdate:modelValue":t[2]||(t[2]=o=>C.email=o),placeholder:"输入你的邮箱/手机号"},{prefix:l(()=>[s(g(Ze))]),_:1},8,["modelValue"])]),_:1}),s(w,{"hide-label":!0,field:"password",rules:[{required:!0,message:"密码不得为空"},{minLength:6,message:"必须输入大于6个字符"}]},{default:l(()=>[s(H,{modelValue:C.password,"onUpdate:modelValue":t[3]||(t[3]=o=>C.password=o),placeholder:"输入你的密码"},{prefix:l(()=>[s(g(J))]),_:1},8,["modelValue"])]),_:1}),a("div",kt,[s(de,{class:"link",href:"/users/reset"},{default:l(()=>[f("忘记密码")]),_:1})]),s(I,{loading:M.value,type:"primary","html-type":"submit",class:"login mb-2"},{default:l(()=>[f(" 登录 ")]),_:1},8,["loading"])]),_:1},8,["model"]),g(_).setting.three_login_open=="1"?(b(),V("div",bt,[wt,g(_).setting.wechat_login=="1"?(b(),V("div",yt,[a("div",null,[a("div",{onClick:t[4]||(t[4]=o=>ye()),class:"inline-flex w-full justify-center rounded-md border border-gray-300 bg-white py-2 px-4 text-sm font-medium text-gray-500 shadow-sm hover:bg-gray-50"},$t)])])):P("",!0)])):P("",!0),a("p",Ct,[f("还没有账户？ "),a("span",{class:"link cursor-pointer",onClick:t[5]||(t[5]=o=>u())},"注册一个"),f(" . ")])])])):ne.value?(b(),V("div",Lt,[a("div",zt,[Ft,St,s(Ne,{src:y.value,alt:""},null,8,["src"])]),s(de,{onClick:N,class:"text-center cursor-pointer"},{default:l(()=>[f("返回登录")]),_:1})])):(b(),V("div",It,[a("div",jt,[Ut,Nt,s(qe,{type:"capsule",modelValue:g(E),"onUpdate:modelValue":t[20]||(t[20]=o=>pe(E)?E.value=o:null),class:"demo-tabs reg_demo_tabs"},{default:l(()=>[F.value=="1"||F.value=="3"?(b(),R(me,{title:"邮箱注册",key:"first"},{default:l(()=>[s(Z,{ref_key:"ruleFormRef",ref:xe,model:c,rules:Ce,class:"demo-ruleForm","status-icon":"",onSubmit:Le},{default:l(()=>[s(w,{"hide-label":!0,"hide-asterisk":!0,field:"email"},{default:l(()=>[s(L,{modelValue:c.email,"onUpdate:modelValue":t[6]||(t[6]=o=>c.email=o),placeholder:"请填写您的邮箱"},{prefix:l(()=>[s(g(at))]),_:1},8,["modelValue"])]),_:1}),s(w,{"hide-label":!0,"hide-asterisk":!0,field:"email_code"},{default:l(()=>[s(O,null,{default:l(()=>[s(L,{modelValue:c.email_code,"onUpdate:modelValue":t[7]||(t[7]=o=>c.email_code=o),placeholder:"邮箱验证码"},{prefix:l(()=>[s(g(ve))]),_:1},8,["modelValue"]),s(I,{loading:x.value,type:"primary",onClick:t[8]||(t[8]=o=>Ie())},{default:l(()=>[f(_e(S.value),1)]),_:1},8,["loading"])]),_:1})]),_:1}),s(w,{"hide-label":!0,"hide-asterisk":!0,field:"password"},{default:l(()=>[s(H,{modelValue:c.password,"onUpdate:modelValue":t[9]||(t[9]=o=>c.password=o),placeholder:"填写您的密码"},{prefix:l(()=>[s(g(J))]),_:1},8,["modelValue"])]),_:1}),s(w,{"hide-label":!0,"hide-asterisk":!0,field:"invite_code",class:"mb-2"},{default:l(()=>[s(L,{modelValue:c.invite_code,"onUpdate:modelValue":t[10]||(t[10]=o=>c.invite_code=o),placeholder:"填写您的邀请码（可选）"},{prefix:l(()=>[s(g(ge))]),_:1},8,["modelValue"])]),_:1}),s(w,{"hide-label":!0,"hide-asterisk":!0,field:"check_xieyi",class:"mb-2 mt-0"},{default:l(()=>[s(ce,{type:"check_xieyi",modelValue:c.check_xieyi,"onUpdate:modelValue":t[11]||(t[11]=o=>c.check_xieyi=o),onClick:t[12]||(t[12]=o=>re())},{default:l(()=>[f(" 同意《用户协议》 ")]),_:1},8,["modelValue"])]),_:1}),s(I,{type:"primary",loading:$.value,class:"register w-100 mb-2","html-type":"submit"},{default:l(()=>[f(" 注册 ")]),_:1},8,["loading"])]),_:1},8,["model","rules"])]),_:1})):P("",!0),F.value=="2"||F.value=="3"?(b(),R(me,{title:"手机注册",key:"second"},{default:l(()=>[s(Z,{ref_key:"ruleFormRefs",ref:Ve,model:m,rules:$e,class:"demo-ruleForm",onSubmit:Se,"status-icon":""},{default:l(()=>[s(w,{"hide-label":!0,"hide-asterisk":!0,field:"phone"},{default:l(()=>[s(L,{modelValue:m.phone,"onUpdate:modelValue":t[13]||(t[13]=o=>m.phone=o),placeholder:"请填写您的手机号"},{prefix:l(()=>[s(g(Ae))]),_:1},8,["modelValue"])]),_:1}),s(w,{"hide-label":!0,"hide-asterisk":!0,field:"phone_code"},{default:l(()=>[s(O,null,{default:l(()=>[s(L,{modelValue:m.phone_code,"onUpdate:modelValue":t[14]||(t[14]=o=>m.phone_code=o),placeholder:"请填写您的手机验证码"},{prefix:l(()=>[s(g(ve))]),_:1},8,["modelValue"]),s(I,{loading:x.value,type:"primary",onClick:t[15]||(t[15]=o=>je())},{default:l(()=>[f(_e(S.value),1)]),_:1},8,["loading"])]),_:1})]),_:1}),s(w,{"hide-label":!0,"hide-asterisk":!0,field:"password"},{default:l(()=>[s(H,{modelValue:m.password,"onUpdate:modelValue":t[16]||(t[16]=o=>m.password=o),placeholder:"填写您的密码"},{prefix:l(()=>[s(g(J))]),_:1},8,["modelValue"])]),_:1}),s(w,{"hide-label":!0,"hide-asterisk":!0,field:"invite_code",class:"mb-2"},{default:l(()=>[s(L,{modelValue:m.invite_code,"onUpdate:modelValue":t[17]||(t[17]=o=>m.invite_code=o),placeholder:"填写您的邀请码（可选）"},{prefix:l(()=>[s(g(ge))]),_:1},8,["modelValue"])]),_:1}),s(w,{"hide-label":!0,"hide-asterisk":!0,field:"check_xieyi",class:"mb-2 mt-0"},{default:l(()=>[s(ce,{modelValue:m.check_xieyi,"onUpdate:modelValue":t[18]||(t[18]=o=>m.check_xieyi=o),onClick:t[19]||(t[19]=o=>re())},{default:l(()=>[f(" 同意《用户协议》 ")]),_:1},8,["modelValue"])]),_:1}),s(I,{type:"primary",loading:$.value,class:"register w-100 mb-2","html-type":"submit"},{default:l(()=>[f(" 注册 ")]),_:1},8,["loading"])]),_:1},8,["model","rules"])]),_:1})):P("",!0)]),_:1},8,["modelValue"]),a("p",qt,[f("已经有账户了? "),a("span",{class:"link cursor-pointer",onClick:t[21]||(t[21]=o=>N())},"登录"),f(".")])])]))])]),_:1},8,["visible"])}}});export{ve as I,Wt as _};
